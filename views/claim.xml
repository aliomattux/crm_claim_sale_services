<openerp>
    <data>

        <record model="ir.ui.view" id="crm_claim_services_form">
            <field name="name">CRM - Claims Form</field>
            <field name="model">crm.claim</field>
            <field name="arch" type="xml">
                <form string="Claim">
                <header>
		    <button name="button_create_claim_delivery_order" type="object" string="Create Delivery Order" attrs="{'invisible': [('claim_action', '!=', 'exchange')]}"/>
		    <button name="button_create_claim_return" type="object" string="Create Return" attrs="{'invisible': [('claim_action', 'not in', ('return','exchange'))]}"/>
                    <button name="button_create_claim_refund" type="object" string="Create Refund" attrs="{'invisible': [('claim_action', 'not in', ('refund','return'))]}"/>
                    <button name="button_create_claim_invoice" type="object" string="Create Invoice" attrs="{'invisible': [('claim_action', '!=', 'exchange')]}" />
		    <field name="state" widget="statusbar" />
                </header>
                <sheet string="Claims">
                    <h1>
                        <label string="Claim " />
                        <field name="name" class="oe_inline" readonly="1"/>
                    </h1>
		    <group>
                        <group>
			    <field name="hidden_sale" invisible="1" />
			    <field name="pricelist_id" invisible="1" />
			    <field name="warehouse" invisible="1" />
			    <field name="sale" attrs="{'invisible': [('sale', '=', False)]}"/>
			    <field name="hidden_partner_id" invisible="1" />
			    <field name="partner_id" attrs="{'readonly': [('sale', '!=', False)]}"/>
			    <field name="hidden_partner_billing_address" invisible="1" />
			    <field name="hidden_partner_shipping_address" invisible="1" />
			    <field name="partner_billing_address" attrs="{'readonly': [('sale', '!=', False)]}" context="{'show_address': 1}" options='{"always_reload": True}'/>
                        </group>
                        <group groups="base.group_user">
                            <field name="user_id" context="{'default_groups_ref': ['base.group_user', 'base.group_partner_manager', 'base.group_sale_salesman_all_leads']}"/>
                            <field name="create_date" readonly="1" string="Created On"/>
                            <field name="section_id" groups="base.group_multi_salesteams"/>
			    <field name="partner_shipping_address" attrs="{'readonly': [('sale', '!=', False)]}" context="{'show_address': 1}" options='{"always_reload": True}'/>
                        </group>
		    </group>
		    <group colspan="4" col="4" string="Cause/Actions">
                        <field name="claim_reason" />
                        <field name="claim_action" />
		    </group>
                    <group colspan="4" col="4">
                        <notebook>
			    <page string="Return/Refund Items" >
				<field name="claim_return_lines" widget="one2many_list" >
				    <tree editable="bottom">
					<field name="product" on_change="onchange_product(product, name, order_qty, product_uom, 'return', parent.partner_id, parent.warehouse, context)"/>
					<field name="name" />
					<field name="route" invisible="1" />
					<field name="type" invisible="1" />
					<field name="order_qty" />
					<field name="product_uom" />
					<field name="sale_price_unit" />
					<field name="tax_id" widget="many2many_tags" domain="[('parent_id','=',False),('type_tax_use','&lt;&gt;','purchase')]"/>
					<field name="discount" />
					<field name="state" invisible="1" />
					<field name="price_subtotal" />
				    </tree>
				</field>
			    </page>
			    <page string="Deliver/Exchanged for Items" attrs="{'invisible': [('claim_action', '!=', 'exchange')]}">
				<field name="claim_delivery_lines" widget="one2many_list" >
				    <tree editable="bottom">
					<field name="product" on_change="onchange_product(product, name, order_qty, product_uom, 'delivery', parent.partner_id, parent.warehouse, context)"/>
					<field name="name" />
					<field name="route" invisible="1" />
					<field name="type" invisible="1" />
					<field name="order_qty" />
					<field name="product_uom" />
					<field name="sale_price_unit" />
					<field name="tax_id" widget="many2many_tags" domain="[('parent_id','=',False),('type_tax_use','&lt;&gt;','purchase')]"/>
					<field name="discount" />
					<field name="state" invisible="1" />
					<field name="price_subtotal" />
				    </tree>
				</field>
			    </page>
                            <page string="Claim Description">
                                <separator colspan="4" string="Claim/Action Description" groups="base.group_user"/>
                                <field name="description" colspan="4" nolabel="1"/>
                            </page>
			    <page string="Accounting">
				<group string="Invoices" colspan="4">
				    <field name="invoice_ids" widget="one2many_list" nolabel="1" >
					<tree>
					    <field name="number" />
					    <field name="state" />
					</tree>
				    </field>
				</group>
			    </page>
                        </notebook>
                    </group>
                </sheet>
                <div class="oe_chatter">
                    <field name="message_follower_ids" widget="mail_followers" groups="base.group_user"/>
                    <field name="message_ids" widget="mail_thread"/>
                </div>
                </form>
            </field>
        </record>

        <record id="crm_claim.action_crm_tag_form_claim0" model="ir.actions.act_window.view">
            <field name="sequence">1</field>
            <field name="view_mode">form</field>
	    <field name="view_id" ref="crm_claim_services_form"/>
            <field name="act_window_id" ref="crm_claim.crm_case_categ_claim0"/>
        </record>

    </data>
</openerp>
